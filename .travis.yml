sudo: required

language: java

jdk:
  - openjdk11
node_js:
  - "lts/*"

services:
  - docker

cache:
  directories:
    - "$HOME/.m2"
    - "$HOME/.npm"
    - "$HOME/.cache"

env:
  global:
    # AWS_ACCESS_KEY_ID
    - secure: QABykuQ8cZk/BokNY4FT/ikXbHMENsBLh8I/Ho4z1Yqt+VrmtQWX214bX8qVRKQu3dXxGLUjKbakM7kcAzlOWIL5UO1FKqJcxz8hBcEdxexYW5l/HYy5NITHEoqg0sC0pO6yAhDJuTDEo8JZGNR5HknQzxvzqnIa1h3vXR5HhK2LvqaqFkfhWO9rCkDn9QLm+lWBYGn8rmaf/QwFXqBhfVyBikTIN+wJcR4QjeYwxbm2IyAQyL4lLzLjlmy6wjEZdvnaXDbVVgZxC8WyGDsd8ojTM+BBPzGiEZajy41QBfBmbEOGo7nfBzD8B8lGvytIlbGyjvofeKfkrswq60i3Wfk/WUE1ExzrMhtURWLLfM9CzaiRv/vXGwiJmeHG/M50AuDtwijS0h0BgqJifZL9nQMpsd2f5eAmBFDK6u43ZmKoWW60DKCAdFJqpn3w6iOyA5p2oKxWSKqN+fjqiVU1S7kik7ACXmrjDOEMPxAbKsFP85wJwITtirBmJH28pfkt3N8oaDhEL08vhKr9SiCHSThuBmjtVQnQRd4BJybcKsI/kd8ZhHktKKowhXyxO4VFtcaaqKPpUBqcsx6bXbvNu5QH8FyO8jRv/ahLmhWWwnASuGpM/EE2c+uV4Q2Xg96uTjGqS7EbBInZmse6D+ggDLBW81VPQB0SQsfosY1IA8U=
    # AWS_SECRET_ACCESS_KEY
    - secure: lY0VnTYKvHjdvOdBLyEah88msIAHFOXOw2Svna9EFAdBQlxoWoozENcFyMNoclZ4ZUxaiXZvtjM0MlU5vq4SdYeHzJgzoe1IvYeNPFUDGHLgPHGF1AfiLhB8KVXSX2JwYpLNleer6hPo9tOmhjqheiT6xivhtLmhjp2QD3YLIo5mYyBi1r29nflZb3UDf8frczGoKJa0Qw5cdF87R1orQt6gJ42DT3Omt7mwUhURHkPN4VAOpfUkboHKMtSskndfogfRwWQ9fO1cCi5t/t/dyR6SwrCqKjxHvflWzylm/9951EgZlMl9FaGEcPBKgo/Yn596U77FtJbPZZBR2Vpglx66J1gR/II2eFmPxJxvvizTnqp9BqrWwT+6OZFriSkrD6/Z2L+zl13LnVXaHf3v0W4IQOW3QEcLaCcskc0OstWZpGkjJ9jyRR+bunhWU3FzBNuOdlV6nPq8RrbdrFVlUFEgO1zage5f5EyUAWAlF8q9sLpNwExAOj9l6/tEZjMoUWKVBfAeuMV3qp6MjnCmUAOuHa+mOqjgNE3ZDQfjC0XBPwXlEuMe2cAhNyaCqqziHYVglVNsXg0UvJl/fQVq2d2pkRJr69rqkjZbelHGkHYSabCqgpFfRh+XdFw2DjT0dalCfPiY1Ao6BUda1CT3IlXC/HtUeeatIoh90TUtoFE=

install:
  - git clone https://github.com/Opetushallitus/ci-tools.git
  - source ci-tools/common/setup-tools.sh
  - export ARTIFACT_NAME="yki-frontend"

script: ./scripts/ci-build.sh

deploy:
  provider: script
  script: "./ci-tools/build/upload-image.sh $ARTIFACT_NAME"
  on:
    all_branches: true
    condition: $TRAVIS_EVENT_TYPE != cron

notifications:
  flowdock:
    secure: oQfd5NgPVYEAfS8d6De/zwus7jttQRgwHSJI4xNXcYwLyxr8EwgkbvcwzNRneUKJrxav77dpkHE2eOZNTCMHzdWxqVlFCzA83KkYN17LrI4BoJ8ZGPFwDu2ktbXIsFAWyHsOgBE3m5Lfxesuh2/a/MuhLzg9o6kjbc6vDPZVNVy0C0S6oVfm6iUWviCS2V2VNxlieV5ljAnfFk8bl6fEtfygZuD6UnBq4eNKm3YtUeMYV01+u4UfDPxe1qggtfoX2OWe5A9QdgZdyptQ7zpbt/XaCM/VRTq0zDDA0Q/fapBFmWI8vVJQXkD0ZGY1gWaBn2Tm/P8V8GDm2B0CRLAfnke85YnkuSySdmcnmLNWUncdXRQXnjSFJARinD2bbYs/IWGeO9o1Ktrtr7fQQwSy66anATr3e2KKglUf3+aba/DhDGS8vMByi+iS2u95hDn/ojS7+t9HP9h94RFtPn2t+fGWIQyDtk/0DS886/p1MbX6vDLRop3xMw4VMhBKs39o5wIof7jSeXcrsZG13XjYAY6VSqJ4TjdGFzLi1AQs9qnjmIXjLBodvVZEp8F0W7ZxOcpn9EtQ+3qg8RTBgLyILpjhBDrrHTF+LOIGnbUKZxPSc683DjNTjfNFQckDWApli6UzjLViK3Z4W+s3bo6y6OdSXDLvXd3nu3GJiCJ85gM=
